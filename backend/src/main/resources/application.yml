# =============================================================================
# BASE CONFIGURATION (APPLIES TO ALL PROFILES)
# Defines structure and default values for all properties
# =============================================================================
spring:
  profiles:
    active: "@spring.profiles.active@"
  application:
    name: ecommerce_backend
  servlet:
    multipart:
      max-file-size: 8MB
      max-request-size: 8MB
  datasource:
    # Driver is common, but URL/credentials are profile-specific
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    properties:
      hibernate:
        format_sql: true
    open-in-view: false
    hibernate:
      # This is a good default; profiles can override to 'none' for safety
      ddl-auto: validate
  springdoc:
    swagger-ui:
      path: /swagger-ui.html
    api-docs:
      path: /api-docs
  flyway:
    default-schema: ecommerce_dev
  thymeleaf:
    cache: false
    prefix: classpath:/templates/
    suffix: .html

management:
  endpoints:
    web:
      exposure:
        include: prometheus,health,info,metrics

server:
  port: 8080

# =============================================================================
# CUSTOM APPLICATION PROPERTIES (COMMON DEFAULTS)
# =============================================================================
app:
  notification:
    channels:
      email:
        activeProvider: "smtp"
        defaultFrom: "noreply@ecommerce.com"
      sms:
        activeProvider: "twilio"
        defaultFrom: "+15551234567"
    vendors:
      smtp:
        host: ${SPRING_MAIL_HOST:mailhog} # Default for local/container dev
        port: ${SPRING_MAIL_PORT:1025}
        protocol: "smtp"
        properties:
          mail.smtp.auth: "false"
          mail.smtp.starttls.enable: "false"
  jwt:
    secret: ${JWT_SECRET} # Secret must be provided by the environment
  storage:
    secret-salt: ${STORAGE_SECRET_SALT} # Secret must be provided
  payment:
    providers:
      stripe:
        enabled: true
        display-name: "Credit / Debit Card"
        api-key: ${STRIPE_API_KEY}
        webhook-secret: ${STRIPE_WEBHOOK_SECRET}
        supported-methods:
          - CREDIT_CARD
          - BLIK
      paypal:
        enabled: false
        display-name: "PayPal"
        client-id: ${PAYPAL_CLIENT_ID}
        client-secret: ${PAYPAL_CLIENT_SECRET}
        supported-methods:
          - BANK_TRANSFER